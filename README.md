# Морозова Юлия, OTUS, группа Postgre-DBA-2023-11

## Домашнее задание №1 по теме: «SQL и реляционные СУБД. Введение в PostgreSQL»

<br/><br/>

1. Создаю в яндекс облаке виртуальную машину:

![1](https://github.com/Y-M-Morozova/1_homework_Morozova_Yulia/assets/153178571/9ffc528f-2dcd-4417-918e-68f9f3885fdc)

<br/><br/>

2. C помощью puttygen создаю ssh ключи и подключаюсь посредством putty по публичному IP-адресу к своей виртуальной машине в яндекс облаке:

![2](https://github.com/Y-M-Morozova/1_homework_Morozova_Yulia/assets/153178571/ac285f1e-9cb4-4f0b-a2aa-1b79d39599b5)

<br/><br/>

3. Устанавливаю PostgreSQL 15й версии и проверяю кластер:

![3](https://github.com/Y-M-Morozova/1_homework_Morozova_Yulia/assets/153178571/7ce9b09e-767e-4f9b-b4a6-0db31b40fa78)

<br/><br/>

4. С помощью putty открываю вторую SSH-сессию, в обеих сессиях запускаю psql от пользователя postgres, проверяю AUTOCOMMIT, отключаю его и еще раз проверяю:

![4](https://github.com/Y-M-Morozova/1_homework_Morozova_Yulia/assets/153178571/eea2553e-c981-4d06-bfd0-b88bef2494cc)

<br/><br/>

5. В первой сессии(слева на скриншоте) создаю таблицу persons и проверяю в обеих сессиях уровни изоляции. В обеих сессиях уровень изоляции стоит – READ COMMITTED(по умолчанию):

![5](https://github.com/Y-M-Morozova/1_homework_Morozova_Yulia/assets/153178571/3341bd06-080a-48c6-a265-7a9f4e9870f0)

<br/><br/>

6. Рассматриваю уровень изоляции транзакций READ COMMITTED:

  - в обеих сессиях выключаю и проверяю AUTOCOMMIT, смотрю текущий уровень изоляции транзакций – он соответствует уровню по умолчанию READ COMMITTED и начинаю в обеих сессиях новую транзакцию в этом уровне изоляции. В первой сессии(на скриншоте слева) вставляю новую запись и проверяю содержимое таблицы в обеих сессиях:
   
![6](https://github.com/Y-M-Morozova/1_homework_Morozova_Yulia/assets/153178571/c7b274d9-603c-45d9-98d6-73cfb9911464)

  **По результату селекта вижу, что во второй сессии новой строки нет. И это объясняется тем, что транзакции активны, открыты в уровне изоляции RAED COMMITTED, который предотвращает аномалию чтения «грязных» данных (запрос НЕ видит незафиксированные изменения других транзакций!).**

  - завершаю транзакцию в первой сессии(слева на скриншоте) и проверяю селектом таблицу во второй сессии:

![7](https://github.com/Y-M-Morozova/1_homework_Morozova_Yulia/assets/153178571/d43c25e1-3db9-4019-b066-b66bfa09e9d1)

**Теперь вижу, что во второй сессии(окно справа), уже есть третья строка! Это объясняется тем, что при уровне изоляции READ COMMITTED в рамках одной транзакции мы видим зафиксированные(COMMIT) данные, которые были зафиксированы до начала запроса в рамках одной танзакции!**

<br/><br/>

7. Рассматриваю уровень изоляции транзакций REPEATABLE READ:

  - в обеих сессиях открываю новые repeatable read транзации, далее в первой сессии вставляю новую запись и проверяю селектом таблицу persons в обеих сессиях:

![8](https://github.com/Y-M-Morozova/1_homework_Morozova_Yulia/assets/153178571/4daf832b-1527-4970-8f1a-8734675dc8d4)



**По результату селекта вижу, что в первой сессии(слева) новая строка есть, а во второй нет.  Это объясняется тем, что изоляция REPEATABLE READ так же не поддерживает чтение «грязных» - незафиксированных данных)**


  - далее я завершаю транзакцию в первой сессии(окно слева), а во второй снова проверяю таблицу persons: 

![10](https://github.com/Y-M-Morozova/1_homework_Morozova_Yulia/assets/153178571/b3e9dd4b-7493-40ee-8cc8-066ee9fa20d9)

**По результату селекта вижу, что в первой сессии(слева) все так же новая строка есть, а во второй сессии этой новой строки все так же -  нет.  Это объясняется тем, что транзакция открыта в уровне изоляции repeatable read!(видны только те данные, которые были зафиксированы до начала транзакции, но не видны внесённые и зафиксированные данные, произведённые другими транзакциями в процессе выполнения данной транзакции!)**


  - Завершаю транзакцию во второй сессии(справа на скриншоте) и проверяю таблицу persons:

![11](https://github.com/Y-M-Morozova/1_homework_Morozova_Yulia/assets/153178571/9f6b4b20-53fb-4b1a-b629-cd4d0fba339b)

**По результату селекта вижу, что во второй сессии уже видны все 4 строки! Так как этот селект уже вызван в рамках другой транзакции.**
<br/><br/>
<br/><br/>
***

**Таким образом в рамках данного домашнего задания на практике вижу, что уровень изоляции транзакций REPEATABLE READ отличается от READ COMMITTED тем, что запрос в транзакции данного уровня REPEATABLE READ видит снимок данных на момент начала первого оператора в ТРАНЗАКЦИИ, а не начала ТЕКУЩЕГО ОПЕРАТОРА транзакции. То есть последовательные команды SELECT в ОДНОЙ транзакции REPEATABLE READ видят одни и те же данные; они не видят изменений, внесённых и зафиксированных другими транзакциями после начала их текущей транзакции.**
***
